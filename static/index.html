
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>CSGO Price Checker</title>
  <style>
    body {
      background: url('/static/center_gradient_586480_to_354057.png') center center / cover no-repeat fixed;
      font-family: Helvetica, sans-serif;
      color: #49D5C1;
      text-align: center;
      padding-top: 12vh;
    }

    input {
      padding: 10px;
      font-size: 18px;
      width: 400px;
      border-radius: 8px;
      border: none;
      outline: none;
    }

    button {
      margin-left: 10px;
      padding: 10px 16px;
      font-size: 18px;
      background: #49D5C1;
      color: #000;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }

    .autocomplete-list {
      position: absolute;
      background: #1e1e2f;
      border: 1px solid #49D5C1;
      border-radius: 12px;
      max-height: 200px;
      overflow-y: auto;
      z-index: 1000;
      margin: 0 auto;
      padding: 0;
      list-style: none;
      width: 400px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.25);
      left: 50%;
      transform: translateX(-50%);
    }

    .autocomplete-list li {
      padding: 10px 16px;
      cursor: pointer;
      color: #49D5C1;
      font-size: 16px;
    }

    .autocomplete-list li:hover {
      background-color: #49d5c120;
    }
  </style>
</head>
<body>
  <h1>CSGO Price Checker</h1>
  <input type="text" id="skinInput" placeholder="Введите название скина" autocomplete="off">
  <button onclick="checkPrice()">Проверить</button>
  <ul id="autocomplete" class="autocomplete-list"></ul>
  <pre id="result" style="margin-top: 20px; white-space: pre-line;"></pre>

  <script>
    const input = document.getElementById('skinInput');
    const list = document.getElementById('autocomplete');

    input.addEventListener('input', async () => {
      const value = input.value.toLowerCase();
      list.innerHTML = '';
      if (value.length < 2) return;

      try {
        const response = await fetch('/api/skins');
        const skins = await response.json();
        const matches = skins.filter(s => s.toLowerCase().includes(value));
        matches.slice(0, 10).forEach(name => {
          const li = document.createElement('li');
          li.textContent = name;
          li.onclick = () => {
            input.value = name;
            list.innerHTML = '';
          };
          list.appendChild(li);
        });
      } catch (e) {
        console.error("Ошибка при получении подсказок:", e);
      }
    });

    async function checkPrice() {
      const name = input.value.trim();
      if (!name) return;
      try {
        const res = await fetch('/api/price?name=' + encodeURIComponent(name));
        const data = await res.json();
        document.getElementById('result').textContent = data.text || 'Нет данных';
      } catch (e) {
        console.error("Ошибка при получении цены:", e);
        document.getElementById('result').textContent = "Ошибка получения данных.";
      }
    }
  </script>
</body>
</html>
